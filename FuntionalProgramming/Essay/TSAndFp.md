## 타입스크립트와 함수형 프로그래밍

### 자바스크립트의 문제점
- 자바스크립트를 코딩할 때는 엄격한 타입에 의한 코딩을 하기 보다는 몇 가지 값을 넣었을 때 당장 눈에 보이는 결과물에 초점을 맞추어 코딩을 하기 쉽다. 여러 기능에서 사용하는 공통적인 기능이 있을 때 공통적인 기능의 변경이 일어날 때 사용하는 모든 대상에 대한 확인 보다는 일부 사례에 대한 확인하여 수정을 하게 되고, 이 때문에 다른 기능에 에러가 나는 경우가 발생하는 경우가 발생한다.
- 타입이 엄격한 언어의 경우, 변수의 범위를 생각하여 해당 범위에 맞는 로직을 만들게 되지만, 자바스크립트를 코딩할 때는 변수가 가지는 범위를 생각하지 않고, 코딩을 할 때 입력한 일부 케이스에 대한 동작만을 확인하는 경우가 있다. 런타임에서 미처 생각하지 않았던 타입의 값 또는 범위 밖의 값이 들어 왔을 때 이상한 동작을 하게 되지만 이에 대한 충분한 처리를 하지 않기 때문에 코드에 버그가 있어도 발견하지 못하는 경우도 있다.
- 어떤 코드를 짤 때는 해당 코드가 어떤 조건에서 동작하는지 조건을 명시하는 것이 좋다. 만들어둔 기능을 다른 맥락에서 사용할 때도 명기된 조건에 맞춰서 사용을 하게 되고, 의도되지 않은 사용법으로 사용하지 않게 된다. 공통의 코드를 변경할 때는 명기된 조건에 따라 다른 모든 곳에서 사용했기 때문에 명기된 조건 내에서 동작한다면 다른 코드와의 상호작용을 고려하지 않고 변경을 할 수 있다는 장점이 있다.
- 하지만 대부분의 자바스크립트 코드는 이런 조건 명기 없이 코드를 짜는 경우가 많고, 이로 인해서 복잡한 로직 및 재사용성이 많은 로직을 만들다보면 코드를 나눈다고 하더라도 의도한 조건 이외의 방식으로 사용한 로직으로 인해서 조합된 코드 간의 의존성이 발생하게 된다. 기존에 잘 동작하던 코드가 추가 기능으로 인해 변경이 일어날 때, 해당 기능을 이용하던 어떤 코드에서는 잘 동작하지만 어떤 코드에서는 동작이 이상하게 변할 수 있다.
- 코드를 변경하고 리펙토링을 하려고 해도 조건이 미리 지정되지 않았기 때문에 의도하지 않은 방식으로 이용한 모든 코드를 확인해야하는 문제점이 발생하며 리펙토링을 하기 어려워진다.

### 자바스크립트에서의 함수형 프로그래밍
- 함수형 프로그래밍은 추상화의 한 방법이다. 추상화란, 외형을 보고서 내부의 코드를 확인하지 않더라도 어떤 동작을 하는지 알 수 있는 코드를 의미한다. 함수형 라이브러리는 어떤 값이 입력되고 어떤 값이 출력되는지 도큐먼트가 제공이 되며, 순수함수이므로 입력에 대해 출력 값이 정해져 있다. 따라서 함수형 프로그래밍을 통해서 코드를 짜게 되면, 추상화된 대상을 이용하더라도 명확한 스펙에 의한 사용법을 따르게 되고, 참조 투명하므로 내부의 동작을 신경써서 코드를 만들 필요가 없기 때문에 코드 간의 의존성을 줄일 수 있다는 장점이 있다.
- 재사용 가능한 순수함수를 만들어내기 위해서는 스펙을 명확하게 만들어야 한다. 그리고 명확한 스펙을 가진 대상들을 조합하여 계속적으로 명확한 스펙을 가진 고차함수들을 생성한다. 고차함수의 함수명과 파라메터명으로 표현되는 이름에 한계가 있을 경우, 조합을 통해서 코드를 만드는 등 스펙의 명확홤을 위해서 노력한다. 코드의 변경은 함수의 조합의 변경이고, 고차함수를 이루는 조합이 변경되면 그에 맞게 함수의 이름도 스펙도 변경이 되는 등 입력에 대한 출력의 예측 가능성을 만들기 위해서 노력하게 된다. 이를 통해서 안전한 프로그램을 만들게 되는 것이다.
- 또한 유닛 테스트 코드를 작성하기도 쉬운데, 각각의 순수함수의 유닛 테스트는 바로 해당 기능의 사양을 더욱 분명하게 하는 것이다. 함수형으로 코드를 작성하는 모든 과정은 일반적인 코드를 짜는 것 보다 훨씬 어려운데 이는 조합 가능한 작은 단위의 함수를 구성하려고 많은 고민을 해야하기 때문이다. 하지만 그 때문에 코드가 명확하게 동작한다는 장점이 있다.

### 잘 짜여진 자바스크립트
- 함수형 프로그래밍을 하는 만큼의 공을 들여서 자바스크립트 로직도 스펙을 명확하게 만들어서 코드를 만들 수 있을 것이다. 동작의 범위를 명확하게 정의하기 위해서 JSDoc으로 유형을 표기해서 코드의 동작 범위 스펙을 기술하는 방법도 있으며, 단위 테스트가 가능한 코드를 만들기 위해 노력한다면 스펙을 명확하게 만들 수 있다.
- 하지만 아무리 잘 짜여진 자바스크립트 코드라고 하더라도 문제는 모든 동적 타입 언어가 마주하는 문제로 코드를 변경했을 때 해당 코드를 사용하고있는 모든 코드의 변경이 잘 이뤄졌는지 확인하는 과정이 필요한데, 강타입 유형의 언어가 컴파일을 통해서 이런 부분들을 쉽게 잡아내는 것과 달리, 동적 언어는 미처 확인하지 못했다가 런타임에 돌아갈 때의 에러 또는 사용자의 보고를 통해서 알 수 있게 되는 문제가 있다. 변경에 영향을 줄만한 코드의 경우의 수를 모두 실행하고 그 결과를 알 수 있도록 테스트 시나리오를 만들고 실행을 해서 검증을 하던가 또는 해당 코드들을 실행해 볼 수 있는 테스트 코드를 만들어야 한다. 하지만 테스트 커버리지가 충분히 높은 프로젝트는 드물다. 런타임의 실행 조건이 복잡하거나 포착하기 어려운 경우 일어날 수 있는 모든 런타임의 동작을 확인하는 것이 불가능한 경우가 많다.

### 자바스크립트에서 함수형 코딩의 이점
- 함수형 프로그래밍은 순수 함수를 만들기 때문에 외부 변수의 참조에서 자유롭다는 설명이 많다. 하지만 이것은 충분한 설명이 되지 못하며, 더 중요한 것은 인풋에 대한 아웃풋의 결과값이 결정된다는 것이다.
- 함수형 프로그램밍에서 만드는 함수는 함수혐과 매개 변수는 어떤 인풋을 넣었을 때 어떤 아웃풋이 생성되는지 알 수 있어야 한다. 함수형 프로그래밍에서 가능한 작은 단위의 함수를 만드는 것도 이름과 매개변수에 적합한 함수를 만들려고 하기 때문이다.
- 함수의 이름과 매개변수를 통해서 함수의 스펙이 명확하게 결정이 되고 한 번 제대로 만들어진 함수는 변경의 가능성이 적고, 이미 검증된 함수들을 재사용하는 것을 통해서 추가된 코드와 재사용된 함수와의 결합이 확인하면 된다는 장점이 있다.
- 함수의 스펙이 변경된다면 기존의 함수를 변경하는 것이 맞는지 기존의 스펙은 적절하므로 새로운 함수를 만들 것인지를 정의하면서 코딩을 하게 되므로 변경 사항에 대응하기 쉽다는 장점이 있다.
- 함수형 코딩의 장점은 테스트 코드의 검증이 쉽다는 점이다. 이미 잘 만들어진 함수는 더는 변경이 잘 되지 않고, 변경이 되더라도 큰 폭의 변경이 잘 없으므로 추가적인 테스트코드를 작성하는 것이 용이하다. 또한 작은 단위로 작성된 함수들의 경우 테스트 코드도 다양한 상태를 확인하기 보다 인풋에 대한 아웃풋이 잘 동작하는지만 확인하면 되기 때문에 여러가지 조건에 대한 검증 로직을 만들지 않아도 된다.

### 타입스크립트의 등장
- 타입 스크립트의 경우, 타입이 두 가지 이상 선언된 변수라면 선언된 타입 모두에 해당하는 처리를 하지 않으면 타입 에러를 발생시킨다. 코드를 추가 변경 제거 할 때 선언된 타입 범위 누락이 있다면 알려주는 것을 통해서 코드의 실수를 바로 잡기에 좋다.
- 타입스크립트의 등장으로 변수가 가질 수 있는 타입을 제한을 하게 되고, 타입을 제한하는 것으로 인해 기능의 스펙이 명확해지는 장점이 생겨났다. 자바스크립트를 사용할 때는 코드의 동작 범위에 대한 스펙을 명확히 하지 않는 경우가 많았다. 일단 일부 값으로 동작이 되기 때문에 만든 코드이므로 어떤 범위에서 동작이 보증된다던지 이런 스펙 없이 코드가 만들어 졌다. 특정 범위에서만 작동해야 하는 것을 암묵적으로 가정하는 코드였는데 명확한 동작 범위에 대한 스펙이 없으므로 잘 동작하던 동작 범위 이상의 범위에서 동작하게 만들거나 기존에 동작하던 범위의 동작이 이뤄지지 않도록 범위의 축소가 이뤄진다던가 스펙의 변경이 자꾸 이뤄지는 문제가 생긴다.
- 자바스크립트는 기능의 스펙 변경으로 인해서 코드의 동작 범위를 유추하는 작업이 어려워지고, 여러 맥락에서 사용되는 공통 기능의 변경으로 의존성이 발생하는 문제점이 있었다. 하지만 타입스크립트는 코드의 타입을 명확하게 하고, 함수형 프로그래밍 처럼 엄격한 추상화를 하지 않더라도 타입이 잘못된 경우 타입스크립트가 알려주기 때문에 논리적인 실수가 아니라면 문제가 생기는 일을 줄일 수 있게 되면서 타입스크립트만으로도 문제를 해결하기에 충분한 상황에 이르렀다.

### 타입스크립트의 문제
- 타입스크립트를 사용한다고 해도 여전히 문제는 있다. 타입시스템으로 검증할 수 없는 종류의 에러 또는 도메인의 논리적 문제 등이 있을 수 있다. 이런 문제는 강타입 언어 어느것이든지 그러하다. 더 중요한 문제는 타입스크립트 개발자들 중에는 한 단위를 이루는 코드가 갖는 타입의 정의를 생각하기 보다는 자신이 만든 코드에 타입 에러가 생겼으니까 타입 문제를 해결하기 위해서 기존의 잘 정의된 스펙의 코드를 변경 하는 등의 문제가 있기도 하다. 단순히 동작의 실행만을 확인하고 코드의 스펙을 정의하고 고민하면서 개발하지 않았다면 각 기능이 가져야 할 타입이 무엇인지를 생각하지 않고 타입을 짜맞추기 위해 이 코드 저 코드 수정하는 일이 생겨 버린다.

### 함수형 라이브러리의 몰락
- 자바스크립트만을 다루던 시절에는 함수형 라이브러리는 추상화하기에 적합한 툴이었다. 하지만, 타입스크립트가 등장하고나서 엄격한 타입 검사를 통해서 함수형 프로그래밍의 추상화 없이도 코딩의 실수 및 잘못된 타입 검사를 할 수 있게 되었다. 배우는데 많은 시간이 들고 함수형 라이브러리를 오래 사용하지 않았다면 이해하기 어려운 코드들을 만들어내는 것 보다는 타입스크립트를 어느 정도 다루면 누구나 사용할 수 있는 좀 더 초보자 친화적인 코드 스타일을 사용하는 것으로도 충분히 프로덕션에서 동작하는 코드를 만들 수 있게 되었다. 타입스크립트의 등장으로 함수형 라이브러리를 사용한 함수형 프로그래밍 보다는 필요할 때 함수형의 기법을 사용해서 코드를 좀 더 깔끔하게 작성하는 방법이 대세가 되었다.
